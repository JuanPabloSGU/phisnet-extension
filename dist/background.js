(()=>{"use strict";let e=null,o=null,t=[];function r(){chrome.storage.local.get(["jwt","token"],(e=>{if(chrome.runtime.lastError)console.error(chrome.runtime.lastError.message);else{const o=e.jwt,t=e.token;o&&t?(chrome.action.setPopup({popup:"home.html"}),chrome.action.openPopup()):(chrome.action.setPopup({popup:"popup.html"}),chrome.action.openPopup())}}))}chrome.runtime.onInstalled.addListener((()=>{chrome.storage.local.clear(),chrome.storage.local.set({automatic_search:!1},(()=>{chrome.runtime.lastError&&console.error(chrome.runtime.lastError.message),console.log("Automatic Search is disabled")})),chrome.action.setPopup({popup:"popup.html"}),chrome.action.openPopup()})),chrome.runtime.onStartup.addListener((()=>{r()})),chrome.action.onClicked.addListener((()=>{r()})),chrome.tabs.onUpdated.addListener(((e,o,t)=>{t.url?.startsWith("chrome://")||t.active&&"complete"===o.status&&chrome.storage.local.get(["automatic_search"],(o=>{if(chrome.runtime.lastError);else{const t=o.automatic_search;!function(e,o){o?chrome.scripting.executeScript({target:{tabId:e},files:["content.js"]}):console.log("Automatic search disabled",e)}(e,t)}}))})),chrome.runtime.onMessage.addListener(((r,c,s)=>{switch(r.token?(e=r.token,s({message:"Token received"})):r.jwt?(o=r.jwt,s({message:"JWT received"})):r.links&&(t=r.links,s({message:"Links received",links:t})),r.action){case"getJWT":s({jwt:o});break;case"clearJWT":o=null,s({message:"JWT cleared"});break;case"getToken":s({token:e});break;case"clearToken":e=null,s({message:"Token cleared"});break;case"getLinks":!function(e){for(let o=0;o<e.length;o++){const t=e[o];parseFloat(t.score.replace("%",""))>75&&chrome.notifications.create(`phishing_link_${o}`,{type:"basic",iconUrl:"images/notification.png",title:"Phishing Link Found",message:`URL: ${t.url}\nScore: ${t.score}`,priority:2})}}(t),s({links:t})}}))})();